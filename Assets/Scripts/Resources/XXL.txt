-- import "BoardBlock"
local XXL = XXL or {}

local BlockItem = require "BlockItem"
blockItems = {}
sprites = {}

function XXL:new()
    o = o or {}
    setmetatable( o, { __index = self }) 
    return o   
end

function XXL:Hello()
    local space = 126
    local shiftX = 87
    local shiftY = -142
    -- local Obj = Resources.Load("Block")
    local Obj = GameObject.Find("Canvas/GuildCrushWindow/Down/Board/Block").transform
    Obj.gameObject:SetActive(false)
    local board = GameObject.Find("Canvas/GuildCrushWindow/Down/Board").transform
    LoadSprites()
    for i=1,9,1 do
        if blockItems[i] ==nil then 
            blockItems[i] ={}
        end
        for j=1,7,1 do
            if blockItems[i][j] ==nil then
                blockItems[i][j] ={}
            end
            -- local block = GameObject.Instantiate(Obj, board)
            -- blockItems[i][j].block = block
            -- block.gameObject:SetActive(true)
            -- block.transform.localPosition = Vector3(shiftX+(i-1)*space, shiftY-(j-1)*space, 0)
            -- blockItems[i][j].type = math.random(6)
            -- blockItems[i][j].image = blockItems[i][j].block.transform:Find("icon")
            -- blockItems[i][j].image.gameObject:GetComponent(UnityEngine.UI.Image).sprite = sprites[blockItems[i][j].type]
            -- -- block:GetComponent(BoardBlock).x = -1
            -- -- block:GetComponent(BoardBlock).y = -1
            -- -- block:GetComponent(BoardBlock).type = blockItems[i][j].type
            -- block:GetComponent(UnityEngine.UI.Button).onClick:AddListener(Click)
                blockItem = BlockItem:new(i,j,math.random(6))
                blockItem.block:GetComponent(UnityEngine.UI.Button).onClick:AddListener(
                    function()
                        Click(blockItem)
                    end
                )
                blockItems[i][j].blockItem = blockItem
        end
    end
    -- local block = BlockItem:new(1,2,3)
end

function XXL:Update()
    
end

function LoadSprites()
    for i = 1,6,1 do
        -- Textures/Crush/Icon
        sprites[i] = Resources.Load("Textures/Crush/Icon"..i,Sprite)
        -- sprites[i] = Resources.Load("Textures/7Tex/Icon","Icon_"..i,Sprite)
    end
end

function Click(blockItem)
    -- Debug.Log("i = "..blockItem.i..",j = "..blockItem.j..",type = "..blockItem.blockType)
    -- Debug.Log("Click")
    Debug.Log(blockItem)
    Debug.Log(blockItem.blockType)
end

return XXL
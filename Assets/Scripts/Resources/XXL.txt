-- import "BoardBlock"
local XXL = XXL or {}

-- Block = require "Block"
blocks = {}
sprites = {}

function XXL:new()
    o = o or {}
    setmetatable( o, { __index = self }) 
    return o   
end

function XXL:Hello()
    local space = 126
    local shiftX = 87
    local shiftY = -142
    -- local Obj = Resources.Load("Block")
    local Obj = GameObject.Find("Canvas/GuildCrushWindow/Down/Board/Block").transform
    Obj.gameObject:SetActive(false)
    local board = GameObject.Find("Canvas/GuildCrushWindow/Down/Board").transform
    LoadSprites()
    for i=1,9,1 do
        if blocks[i] ==nil then 
            blocks[i] ={}
        end
        for j=1,7,1 do
            if blocks[i][j] ==nil then
                blocks[i][j] ={}
            end
            local block = GameObject.Instantiate(Obj, board);
            blocks[i][j].block = block
            block.gameObject:SetActive(true)
            block.transform.localPosition = Vector3(shiftX+(i-1)*space, shiftY-(j-1)*space, 0)
            blocks[i][j].type = math.random(6)
            blocks[i][j].image = blocks[i][j].block.transform:Find("icon")
            blocks[i][j].image.gameObject:GetComponent(UnityEngine.UI.Image).sprite = sprites[blocks[i][j].type]
            -- block:GetComponent(BoardBlock).x = -1
            -- block:GetComponent(BoardBlock).y = -1
            -- block:GetComponent(BoardBlock).type = blocks[i][j].type
            block:GetComponent(UnityEngine.UI.Button).onClick:AddListener(Click)
        end
    end
    -- local block = Block:new(1,2,3)
    -- Debug.Log(block.type)
end

function XXL:Update()
    
end

function LoadSprites()
    for i = 1,6,1 do
        -- Textures/Crush/Icon
        sprites[i] = Resources.Load("Textures/Crush/Icon"..i,Sprite)
        -- sprites[i] = Resources.Load("Textures/7Tex/Icon","Icon_"..i,Sprite)
    end
end

function Click()
    Debug.Log("Click")
end

return XXL